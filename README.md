# Калькулятор эмиттанса

Проект для анализа данных эмиттанса с вычислением взвешенного стандартного отклонения расстояний и построением графиков зависимостей.

## Структура проекта

```
emittance_calculator/
├── data/                    # Данные для анализа
│   ├── data_1.xlsx
│   ├── test_data_1.xlsx
│   ├── test_data_2.xlsx
│   └── test_data_3.xlsx
├── src/                     # Исходный код
│   ├── __init__.py
│   ├── data_processor.py    # Обработка данных из Excel файлов
│   ├── visualization.py     # Построение графиков
│   └── approximation.py     # Аппроксимация зависимостей
├── results/                 # Результаты анализа
│   └── plots/              # Сохраненные графики
├── main.py                 # Главный скрипт для запуска анализа
├── requirements.txt        # Зависимости проекта
└── README.md              # Документация
```

## Установка и запуск

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Запуск анализа

```bash
python main.py
```

## Функциональность

### Обработка данных (`src/data_processor.py`)
- Чтение данных из Excel файлов
- Вычисление взвешенного стандартного отклонения расстояний
- Обработка множественных файлов с разными значениями field

### Визуализация (`src/visualization.py`)
- Построение графиков зависимостей
- Сохранение графиков в файлы
- Сравнение фактических и аппроксимированных значений

### Аппроксимация (`src/approximation.py`)
- Подгонка различных математических функций к данным
- Сравнение качества аппроксимации
- Автоматический выбор лучшей функции

## Формат данных

Excel файлы должны содержать:
- **Колонка 1**: Расстояния (одинаковые для всех экспериментов)
- **Колонка 2**: Количество измерений для каждого расстояния (эксперимент 1)
- **Колонка 3**: Количество измерений для каждого расстояния (эксперимент 2)

## Результаты

Программа выводит:
- Взвешенные стандартные отклонения расстояний для каждого эксперимента
- Графики зависимостей от значений field
- Сохраненные изображения графиков в папке `results/plots/`

## Зависимости

- pandas==2.1.4
- openpyxl==3.1.2
- matplotlib==3.8.2
- scipy==1.11.4
